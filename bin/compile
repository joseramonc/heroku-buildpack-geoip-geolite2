#!/bin/bash

set -e

BUILD_DIR=$1
CACHE_DIR=$2
ENV_DIR=$3

LIBMAXMINDDB_VERSION=1.2.1
GEOLITE2_CITY_FILENAME="GeoLite2-City.mmdb"
GEOLITE2_CITY_TARBALL_FILENAME="GeoLite2-City.tar.gz"
GEOLITE2_COUNTRY_FILENAME="GeoLite2-Country.mmdb"
GEOLITE2_COUNTRY_TARBALL_FILENAME="GeoLite2-Country.tar.gz"

BUILD_DIST_DIR="$BUILD_DIR/.geoip"
BUILD_DIST_SHARE_DIR="$BUILD_DIST_DIR/share"

GEOIP_CACHE_DIR="$CACHE_DIR/geoip"
LIBMAXMINDDB_CACHE_DIR="$GEOIP_CACHE_DIR/libmaxminddb"
LIBMAXMINDDB_CACHE_DIST_DIR="$GEOIP_CACHE_DIR/libmaxminddb/dist"
LIBMAXMINDDB_CACHE_VERSION_FILE="$LIBMAXMINDDB_CACHE_DIR/libmaxminddb-version"

echo "-----> Installing GeoLite2 data and libmaxminddb from ppa:maxmin/ppa"


add-apt-repository ppa:maxmind/ppa
apt update
apt install libmaxminddb0 libmaxminddb-dev mmdb-bin
